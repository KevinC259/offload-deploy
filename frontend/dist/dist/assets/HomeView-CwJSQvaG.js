import{d as A,r as _,x as E,c as v,y as w,F as T,n as z,a as s,z as C,b as m,i as S,w as D,j as M,f as I,t as V,u as F,A as H,o as c,_ as x,h as N,B as W,C as j,D as q,G,H as J,k as P,I as R,g as U,J as K,K as L}from"./index-CSkJ4Wth.js";import{u as $}from"./auth-CnjZ6pwZ.js";const O=["onClick"],Q={key:1},X={class:"sidebar-item-text"},Y={key:0,class:"collapse-content is-open"},Z=A({__name:"Collapse",props:{items:{},activeItem:{},level:{}},emits:["select"],setup(b,{emit:f}){const r=b,d=f,n=_([]),k=(o,l)=>{if(!l.children||l.children.length===0){l.key&&d("select",l.key);return}n.value.includes(o)?n.value=n.value.filter(i=>i!==o):n.value.push(o)};return E(()=>r.activeItem,o=>{const l=p=>p.findIndex(t=>t.key===o?!0:t.children&&t.children.length>0?l(t.children)!==-1:!1),i=l(r.items);i!==-1&&!n.value.includes(i)&&n.value.push(i)},{immediate:!0}),(o,l)=>{const i=I("el-icon"),p=I("Collapse",!0);return c(),v("div",{class:w(["collapse",`level-${o.level}`])},[(c(!0),v(T,null,z(o.items,(t,u)=>(c(),v("div",{key:t.id||t.key||u,class:"collapse-item"},[s("div",{class:w(["sidebar-item",{"is-active":t.key===o.activeItem,"has-children":t.children&&t.children.length>0}]),onClick:e=>k(u,t)},[m(i,{class:"sidebar-item-icon"},{default:D(()=>[t.icon?(c(),S(M(t.icon),{key:0})):(c(),v("span",Q))]),_:2},1024),s("div",X,[s("span",null,V(t.title),1)]),t.children&&t.children.length>0?(c(),S(i,{key:0,class:w(["collapse-arrow",{"is-open":n.value.includes(u)}])},{default:D(()=>[m(F(H))]),_:2},1032,["class"])):C("",!0)],10,O),t.children&&t.children.length>0&&n.value.includes(u)?(c(),v("div",Y,[m(p,{items:t.children,"active-item":o.activeItem,onSelect:l[0]||(l[0]=e=>d("select",e)),level:o.level+1},null,8,["items","active-item","level"])])):C("",!0)]))),128))],2)}}}),ee=x(Z,[["__scopeId","data-v-2526b2f1"]]),te={class:"container"},se={class:"sidebar"},ne={class:"sidebar-item-list"},oe={class:"main"},le={class:"header"},ae={class:"header-name"},ie={class:"dropdown-link"},ce={key:0,class:"dropdown-menu"},re={class:"content"},de=A({__name:"HomeView",setup(b){const f=_(""),r=_(""),d=_(!1),n=U(),k=R(),o=_([{key:"userList",title:"用户管理",icon:N},{key:"workstation",title:"工作站",icon:W,children:[{key:"stationList",title:"工作站列表"},{key:"stationStats",title:"工作站使用情况统计"}]},{key:"functionModule",title:"功能模块",icon:j,children:[{key:"optimizationTargets",title:"优化目标"},{key:"robustnessAnalysis",title:"鲁棒性分析"},{key:"visualFlow",title:"配置预览"},{key:"model3dEditor",title:"3D模型编辑器"}]},{key:"globalSettings",title:"全局设置",icon:q,children:[{key:"modulePanel",title:"模块配置"}]}]),l=()=>{var B;const e=(B=k.name)==null?void 0:B.toString();if(e!=null&&e.startsWith("nav_"))return;const a=h=>h.flatMap(g=>[g.key||"",...g.children?a(g.children):[]]).filter(Boolean),y=a(o.value);if(e&&y.includes(e))r.value=e;else{const h=y[0];h&&(r.value=h,n.push({name:h}))}},i=e=>{if(r.value=e,e==="stationStats"){n.push({name:"stationList"});return}if(e==="optimizationTargets"){n.push({name:"navigateConfigiration"});return}try{n.push({name:e})}catch(a){console.error("路由跳转失败:",a),L.error({title:"错误",message:`无法跳转到页面: ${e}`})}},p=()=>{d.value=!d.value},t=()=>{d.value=!1,K.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{$().clearAuth(),n.push({name:"Login"}),L.success({title:"成功",message:"已退出登录"})}).catch(()=>{})},u=e=>{const a=document.querySelector(".dropdown");a&&!a.contains(e.target)&&(d.value=!1)};return G(()=>{const e=$();f.value=e.name||"未知用户",l(),document.addEventListener("click",u)}),J(()=>{document.removeEventListener("click",u)}),E(()=>k.name,e=>{e&&typeof e=="string"&&(e.startsWith("nav_")||(r.value=e))}),(e,a)=>{const y=I("router-view");return c(),v("div",te,[s("div",se,[a[0]||(a[0]=s("div",{class:"sidebar-title"},[s("span",null,"后台管理")],-1)),s("div",ne,[m(ee,{items:o.value,"active-item":r.value,onSelect:i,level:1},null,8,["items","active-item"])])]),s("div",oe,[s("div",le,[s("div",ae,[s("div",{class:"dropdown",onClick:p},[s("span",ie,[P(V(f.value),1),a[1]||(a[1]=s("i",{class:"el-icon-arrow-down"},null,-1))]),d.value?(c(),v("div",ce,[s("div",{class:"dropdown-item",onClick:t},"退出登录")])):C("",!0)])])]),s("div",re,[m(y)])])])}}}),pe=x(de,[["__scopeId","data-v-32bda9fe"]]);export{pe as default};
