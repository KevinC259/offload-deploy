import{_ as tt,r as $,L as et,M as at,I as ot,x as lt,G as nt,c as p,a,z as f,b as i,w as d,k as v,f as O,t as u,p as m,P as h,F as z,n as x,y as J,R as b,J as it,E as j,g as st,o as c}from"./index-CSkJ4Wth.js";const dt={class:"topology-optimization-container"},rt={key:0,class:"topology-optimization-module"},ut={class:"topology-optimization-table"},pt={class:"topology-optimization-header"},ct={class:"topology-optimization-header-right"},vt={class:"table-wrapper"},mt={class:"empty-state"},_t={key:0,class:"custom-pagination"},bt={class:"pagination-total"},gt={class:"pagination-sizes"},yt=["value"],ft=["disabled"],wt={class:"pagination-pages"},kt=["onClick"],zt=["disabled"],Ct={key:1,class:"topology-optimization-module"},ht={class:"topology-optimization-table"},xt={class:"topology-optimization-header"},Vt={class:"topology-optimization-header-right"},Ut={class:"table-wrapper"},$t={class:"empty-state"},jt={key:0,class:"custom-pagination"},St={class:"pagination-total"},Tt={class:"pagination-sizes"},Pt=["value"],Ot=["disabled"],Mt={class:"pagination-pages"},Bt=["onClick"],Dt=["disabled"],Wt={key:2,class:"topology-optimization-module"},Lt={class:"topology-optimization-table"},Nt={class:"topology-optimization-header"},Et={class:"topology-optimization-header-right"},It={class:"table-wrapper"},Rt={class:"empty-state"},Jt={key:0,class:"custom-pagination"},Ft={class:"pagination-total"},At={class:"pagination-sizes"},Xt=["value"],Yt=["disabled"],Zt={class:"pagination-pages"},Gt=["onClick"],qt=["disabled"],Ht={key:3,class:"global-actions"},Kt={key:0,class:"el-overlay"},Qt={class:"el-dialog"},te={class:"el-dialog__header"},ee={class:"el-dialog__title"},ae={class:"el-dialog__body"},oe={class:"form-group"},le=["disabled"],ne=["value"],ie={key:0},se={class:"form-group"},de={class:"form-group"},re={class:"form-group"},ue={class:"form-group"},pe={class:"inline-group-container"},ce={class:"form-group"},ve={key:1},me={class:"form-group"},_e={class:"form-group"},be={class:"form-group"},ge={class:"form-group"},ye={class:"inline-group-container"},fe={key:2},we={class:"form-group"},ke={class:"form-group"},ze={class:"el-dialog__footer"},Ce={__name:"TopologyOptimizationView",setup(he){const X=ot(),F=st(),V=$(!1),U=$("add"),l=$({id:null,operationType:"",data:{}}),g=$([]),M=$(!0),_=$(5),B=[5,10,20,50],Y=[{value:"discrete_optimization",text:"拓扑优化"},{value:"transform_object",text:"图形变换"},{value:"subtract_area",text:"图形减法"}],r=et({discrete_optimization:1,transform_object:1,subtract_area:1}),Z=at(()=>X.path.includes("/navigateConfigiration/")),y=o=>g.value.filter(t=>t.operationType===o),D=o=>{const t=y(o),n=(r[o]-1)*_.value,s=n+_.value;return t.slice(n,s)},P=o=>{const t=y(o);return Math.ceil(t.length/_.value)},W=o=>{const t=P(o),n=r[o],s=[],C=Math.max(1,n-2),T=Math.min(t,n+2);for(let e=C;e<=T;e++)s.push(e);return s},w=(o,t)=>{r[o]=t},L=()=>{Object.keys(r).forEach(o=>{r[o]=1})},S=o=>{const t={id:Date.now(),operationType:o,data:{}};switch(o){case"discrete_optimization":t.data={type:"Box",startPoint:"(0,0,0)",cellSize:"1.0",cellU:"10",cellV:"10",cellW:"10",materials:"Copper (annealed)"};break;case"transform_object":t.data={operation:"Translate",name:"Shape_1",repetitionFactor:"1",translationVector:{x:0,y:0,z:0}};break;case"subtract_area":t.data={minuend:"Shape_A",subtraction:"Shape_B"};break}return t},N=o=>{U.value="add",l.value=S(o),V.value=!0},E=o=>{U.value="edit",l.value=JSON.parse(JSON.stringify(o)),V.value=!0},G=()=>{if(U.value==="add")g.value.push({...l.value}),j.success("添加成功");else{const o=g.value.findIndex(t=>t.id===l.value.id);o!==-1&&(g.value[o]={...l.value},j.success("编辑成功"))}V.value=!1,R()},I=async(o,t,n)=>{try{await it.confirm("确定要删除这个操作吗？","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const s=g.value.findIndex(C=>C.id===o.id);s!==-1&&(g.value.splice(s,1),j.success("删除成功"),R())}catch{j.info("已取消删除")}},q=()=>{F.back()},H=async()=>{try{const o=JSON.stringify(g.value,null,4),t=new Blob([o],{type:"application/json"}),n=URL.createObjectURL(t),s=document.createElement("a");s.href=n,s.download="topology_optimization_config.json",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n)}catch(o){throw console.error("导出配置失败:",o),o}},K=async()=>{try{await A(),await H(),j.success("配置已保存并导出，正在跳转到下一步"),F.push("/navigateConfigiration/optimizationTargets")}catch(o){console.error("下一步操作失败:",o),j.error("操作失败，请重试")}},A=async()=>{try{R()}catch(o){throw console.error("保存配置失败:",o),o}},R=()=>{localStorage.setItem("topologyOptimizationConfig",JSON.stringify(g.value))},Q=()=>{const o=localStorage.getItem("topologyOptimizationConfig");o&&(g.value=JSON.parse(o))};return lt(()=>{var o;return(o=l.value)==null?void 0:o.operationType},o=>{if(U.value==="add"&&o){const t=S(o);l.value.data=t.data}}),nt(()=>{if(Q(),g.value.length===0){const o=[];for(let t=1;t<=3;t++){const n=S("discrete_optimization");n.id=t,n.data.startPoint=`(${t},${t},0)`,n.data.cellU=`${10+t}`,n.data.cellV=`${10+t}`,n.data.cellW=`${5+t}`,o.push(n)}for(let t=1;t<=3;t++){const n=S("transform_object");n.id=t+10,n.data.name=`Shape_${t}`,n.data.translationVector={x:t,y:t*2,z:0},o.push(n)}for(let t=1;t<=2;t++){const n=S("subtract_area");n.id=t+20,n.data.minuend=`Shape_A${t}`,n.data.subtraction=`Shape_B${t}`,o.push(n)}g.value=o}}),(o,t)=>{const n=O("el-button"),s=O("el-table-column"),C=O("el-empty"),T=O("el-table");return c(),p(z,null,[a("div",dt,[M.value||y("discrete_optimization").length>0?(c(),p("div",rt,[a("div",ut,[a("div",pt,[t[31]||(t[31]=a("span",null,"拓扑优化",-1)),a("div",ct,[i(n,{type:"primary",onClick:t[0]||(t[0]=e=>N("discrete_optimization"))},{default:d(()=>t[30]||(t[30]=[v("添加")])),_:1})])]),a("div",vt,[i(T,{data:D("discrete_optimization"),style:{width:"100%"},height:"100%"},{empty:d(()=>[a("div",mt,[i(C,{description:"暂无拓扑优化数据"})])]),default:d(()=>[i(s,{label:"序号",width:"150"},{default:d(e=>[v(u((r.discrete_optimization-1)*_.value+e.$index+1),1)]),_:1}),i(s,{prop:"data.type",label:"类型",width:"300"}),i(s,{prop:"data.startPoint",label:"起始点",width:"150"}),i(s,{prop:"data.cellSize",label:"单元大小",width:"150"}),i(s,{label:"单元数(U/V/W)",width:"150"},{default:d(e=>[v(u(e.row.data.cellU)+"/"+u(e.row.data.cellV)+"/"+u(e.row.data.cellW),1)]),_:1}),i(s,{prop:"data.materials",label:"材料",width:"150"}),i(s,{fixed:"right",label:"操作","min-width":"120"},{default:d(e=>[i(n,{size:"small",type:"primary",onClick:k=>E(e.row)},{default:d(()=>t[32]||(t[32]=[v("编辑")])),_:2},1032,["onClick"]),i(n,{size:"small",type:"danger",onClick:k=>I(e.row,e.$index,"discrete_optimization")},{default:d(()=>t[33]||(t[33]=[v("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),y("discrete_optimization").length>0?(c(),p("div",_t,[a("span",bt,"共 "+u(y("discrete_optimization").length)+" 条",1),a("div",gt,[m(a("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>_.value=e),onChange:L},[(c(),p(z,null,x(B,e=>a("option",{key:e,value:e},u(e)+" 条/页 ",9,yt)),64))],544),[[h,_.value]])]),a("button",{disabled:r.discrete_optimization===1,class:"pagination-btn",onClick:t[2]||(t[2]=e=>w("discrete_optimization",r.discrete_optimization-1))}," 上一页 ",8,ft),a("div",wt,[(c(!0),p(z,null,x(W("discrete_optimization"),e=>(c(),p("span",{key:e,class:J(["page-item",{active:e===r.discrete_optimization}]),onClick:k=>w("discrete_optimization",e)},u(e),11,kt))),128))]),a("button",{disabled:r.discrete_optimization===P("discrete_optimization"),class:"pagination-btn",onClick:t[3]||(t[3]=e=>w("discrete_optimization",r.discrete_optimization+1))}," 下一页 ",8,zt)])):f("",!0)])])])):f("",!0),M.value||y("transform_object").length>0?(c(),p("div",Ct,[a("div",ht,[a("div",xt,[t[35]||(t[35]=a("span",null,"图形变换",-1)),a("div",Vt,[i(n,{type:"primary",onClick:t[4]||(t[4]=e=>N("transform_object"))},{default:d(()=>t[34]||(t[34]=[v("添加")])),_:1})])]),a("div",Ut,[i(T,{data:D("transform_object"),style:{width:"100%"},height:"100%"},{empty:d(()=>[a("div",$t,[i(C,{description:"暂无图形变换数据"})])]),default:d(()=>[i(s,{label:"序号",width:"150"},{default:d(e=>[v(u((r.transform_object-1)*_.value+e.$index+1),1)]),_:1}),i(s,{prop:"data.type",label:"类型",width:"300"}),i(s,{prop:"data.startPoint",label:"起始点",width:"150"}),i(s,{prop:"data.cellSize",label:"单元大小",width:"150"}),i(s,{label:"单元数(U/V/W)",width:"150"},{default:d(e=>[v(u(e.row.data.cellU)+"/"+u(e.row.data.cellV)+"/"+u(e.row.data.cellW),1)]),_:1}),i(s,{prop:"data.materials",label:"材料",width:"150"}),i(s,{fixed:"right",label:"操作","min-width":"120"},{default:d(e=>[i(n,{size:"small",type:"primary",onClick:k=>E(e.row)},{default:d(()=>t[36]||(t[36]=[v("编辑")])),_:2},1032,["onClick"]),i(n,{size:"small",type:"danger",onClick:k=>I(e.row,e.$index,"transform_object")},{default:d(()=>t[37]||(t[37]=[v("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),y("transform_object").length>0?(c(),p("div",jt,[a("span",St,"共 "+u(y("transform_object").length)+" 条",1),a("div",Tt,[m(a("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>_.value=e),onChange:L},[(c(),p(z,null,x(B,e=>a("option",{key:e,value:e},u(e)+" 条/页 ",9,Pt)),64))],544),[[h,_.value]])]),a("button",{disabled:r.transform_object===1,class:"pagination-btn",onClick:t[6]||(t[6]=e=>w("transform_object",r.transform_object-1))}," 上一页 ",8,Ot),a("div",Mt,[(c(!0),p(z,null,x(W("transform_object"),e=>(c(),p("span",{key:e,class:J(["page-item",{active:e===r.transform_object}]),onClick:k=>w("transform_object",e)},u(e),11,Bt))),128))]),a("button",{disabled:r.transform_object===P("transform_object"),class:"pagination-btn",onClick:t[7]||(t[7]=e=>w("transform_object",r.transform_object+1))}," 下一页 ",8,Dt)])):f("",!0)])])])):f("",!0),M.value||y("subtract_area").length>0?(c(),p("div",Wt,[a("div",Lt,[a("div",Nt,[t[39]||(t[39]=a("span",null,"图形减法",-1)),a("div",Et,[i(n,{type:"primary",onClick:t[8]||(t[8]=e=>N("subtract_area"))},{default:d(()=>t[38]||(t[38]=[v("添加")])),_:1})])]),a("div",It,[i(T,{data:D("subtract_area"),style:{width:"100%"},height:"100%"},{empty:d(()=>[a("div",Rt,[i(C,{description:"暂无图形减法数据"})])]),default:d(()=>[i(s,{label:"序号",width:"150"},{default:d(e=>[v(u((r.subtract_area-1)*_.value+e.$index+1),1)]),_:1}),i(s,{prop:"data.type",label:"类型",width:"300"}),i(s,{prop:"data.startPoint",label:"起始点",width:"150"}),i(s,{prop:"data.cellSize",label:"单元大小",width:"150"}),i(s,{label:"单元数(U/V/W)",width:"150"},{default:d(e=>[v(u(e.row.data.cellU)+"/"+u(e.row.data.cellV)+"/"+u(e.row.data.cellW),1)]),_:1}),i(s,{prop:"data.materials",label:"材料",width:"150"}),i(s,{fixed:"right",label:"操作","min-width":"120"},{default:d(e=>[i(n,{size:"small",type:"primary",onClick:k=>E(e.row)},{default:d(()=>t[40]||(t[40]=[v("编辑")])),_:2},1032,["onClick"]),i(n,{size:"small",type:"danger",onClick:k=>I(e.row,e.$index,"subtract_area")},{default:d(()=>t[41]||(t[41]=[v("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),y("subtract_area").length>0?(c(),p("div",Jt,[a("span",Ft,"共 "+u(y("subtract_area").length)+" 条",1),a("div",At,[m(a("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>_.value=e),onChange:L},[(c(),p(z,null,x(B,e=>a("option",{key:e,value:e},u(e)+" 条/页 ",9,Xt)),64))],544),[[h,_.value]])]),a("button",{disabled:r.subtract_area===1,class:"pagination-btn",onClick:t[10]||(t[10]=e=>w("subtract_area",r.subtract_area-1))}," 上一页 ",8,Yt),a("div",Zt,[(c(!0),p(z,null,x(W("subtract_area"),e=>(c(),p("span",{key:e,class:J(["page-item",{active:e===r.subtract_area}]),onClick:k=>w("subtract_area",e)},u(e),11,Gt))),128))]),a("button",{disabled:r.subtract_area===P("subtract_area"),class:"pagination-btn",onClick:t[11]||(t[11]=e=>w("subtract_area",r.subtract_area+1))}," 下一页 ",8,qt)])):f("",!0)])])])):f("",!0),Z.value?(c(),p("div",Ht,[i(n,{onClick:q},{default:d(()=>t[42]||(t[42]=[v("返回")])),_:1}),i(n,{type:"primary",onClick:A},{default:d(()=>t[43]||(t[43]=[v("保存配置")])),_:1}),i(n,{type:"success",onClick:K},{default:d(()=>t[44]||(t[44]=[v("下一步")])),_:1})])):f("",!0)]),V.value?(c(),p("div",Kt,[a("div",Qt,[a("div",te,[a("span",ee,u(U.value==="add"?"添加新操作":"编辑操作"),1),a("button",{class:"el-dialog__headerbtn",onClick:t[12]||(t[12]=e=>V.value=!1)},t[45]||(t[45]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[a("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.88 512 214.592 764.288a31.936 31.936 0 1 0 45.12 45.12L512 557.12l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512l252.288-252.288a31.936 31.936 0 1 0-45.12-45.12z"})],-1)]))]),a("div",ae,[a("div",oe,[t[46]||(t[46]=a("label",null,"操作类型:",-1)),m(a("select",{class:"el-select","onUpdate:modelValue":t[13]||(t[13]=e=>l.value.operationType=e),disabled:U.value==="edit"},[(c(),p(z,null,x(Y,e=>a("option",{key:e.value,value:e.value},u(e.text),9,ne)),64))],8,le),[[h,l.value.operationType]])]),l.value.operationType==="discrete_optimization"?(c(),p("div",ie,[a("div",se,[t[48]||(t[48]=a("label",null,"类型:",-1)),m(a("select",{class:"el-select","onUpdate:modelValue":t[14]||(t[14]=e=>l.value.data.type=e)},t[47]||(t[47]=[a("option",null,"Box",-1),a("option",null,"Line",-1)]),512),[[h,l.value.data.type]])]),a("div",de,[t[49]||(t[49]=a("label",null,"起始点:",-1)),m(a("input",{type:"text",class:"el-input","onUpdate:modelValue":t[15]||(t[15]=e=>l.value.data.startPoint=e)},null,512),[[b,l.value.data.startPoint]])]),a("div",re,[t[50]||(t[50]=a("label",null,"单元大小:",-1)),m(a("input",{type:"text",class:"el-input","onUpdate:modelValue":t[16]||(t[16]=e=>l.value.data.cellSize=e)},null,512),[[b,l.value.data.cellSize]])]),a("div",ue,[t[51]||(t[51]=a("label",null,"U/V/W轴单元数:",-1)),a("div",pe,[m(a("input",{type:"text",class:"el-input","onUpdate:modelValue":t[17]||(t[17]=e=>l.value.data.cellU=e),placeholder:"U"},null,512),[[b,l.value.data.cellU]]),m(a("input",{type:"text",class:"el-input","onUpdate:modelValue":t[18]||(t[18]=e=>l.value.data.cellV=e),placeholder:"V"},null,512),[[b,l.value.data.cellV]]),m(a("input",{type:"text",class:"el-input","onUpdate:modelValue":t[19]||(t[19]=e=>l.value.data.cellW=e),placeholder:"W"},null,512),[[b,l.value.data.cellW]])])]),a("div",ce,[t[53]||(t[53]=a("label",null,"材料:",-1)),m(a("select",{class:"el-select","onUpdate:modelValue":t[20]||(t[20]=e=>l.value.data.materials=e)},t[52]||(t[52]=[a("option",null,"Copper (annealed)",-1),a("option",null,"PEC",-1),a("option",null,"Vaccum",-1)]),512),[[h,l.value.data.materials]])])])):f("",!0),l.value.operationType==="transform_object"?(c(),p("div",ve,[a("div",me,[t[55]||(t[55]=a("label",null,"变换类型:",-1)),m(a("select",{class:"el-select","onUpdate:modelValue":t[21]||(t[21]=e=>l.value.data.operation=e)},t[54]||(t[54]=[a("option",null,"Translate",-1),a("option",null,"Rotate",-1),a("option",null,"Mirror",-1)]),512),[[h,l.value.data.operation]])]),a("div",_e,[t[56]||(t[56]=a("label",null,"图形名称:",-1)),m(a("input",{type:"text",class:"el-input","onUpdate:modelValue":t[22]||(t[22]=e=>l.value.data.name=e)},null,512),[[b,l.value.data.name]])]),a("div",be,[t[57]||(t[57]=a("label",null,"重复次数:",-1)),m(a("input",{type:"text",class:"el-input","onUpdate:modelValue":t[23]||(t[23]=e=>l.value.data.repetitionFactor=e)},null,512),[[b,l.value.data.repetitionFactor]])]),a("div",ge,[t[58]||(t[58]=a("label",null,"变换向量 (X,Y,Z):",-1)),a("div",ye,[m(a("input",{type:"number",class:"el-input","onUpdate:modelValue":t[24]||(t[24]=e=>l.value.data.translationVector.x=e),placeholder:"X"},null,512),[[b,l.value.data.translationVector.x,void 0,{number:!0}]]),m(a("input",{type:"number",class:"el-input","onUpdate:modelValue":t[25]||(t[25]=e=>l.value.data.translationVector.y=e),placeholder:"Y"},null,512),[[b,l.value.data.translationVector.y,void 0,{number:!0}]]),m(a("input",{type:"number",class:"el-input","onUpdate:modelValue":t[26]||(t[26]=e=>l.value.data.translationVector.z=e),placeholder:"Z"},null,512),[[b,l.value.data.translationVector.z,void 0,{number:!0}]])])])])):f("",!0),l.value.operationType==="subtract_area"?(c(),p("div",fe,[a("div",we,[t[59]||(t[59]=a("label",null,"被减数:",-1)),m(a("input",{type:"text",class:"el-input","onUpdate:modelValue":t[27]||(t[27]=e=>l.value.data.minuend=e)},null,512),[[b,l.value.data.minuend]])]),a("div",ke,[t[60]||(t[60]=a("label",null,"减数:",-1)),m(a("input",{type:"text",class:"el-input","onUpdate:modelValue":t[28]||(t[28]=e=>l.value.data.subtraction=e)},null,512),[[b,l.value.data.subtraction]])])])):f("",!0)]),a("div",ze,[i(n,{onClick:t[29]||(t[29]=e=>V.value=!1)},{default:d(()=>t[61]||(t[61]=[v("取消")])),_:1}),i(n,{type:"primary",onClick:G},{default:d(()=>t[62]||(t[62]=[v("确定")])),_:1})])])])):f("",!0)],64)}}},Ve=tt(Ce,[["__scopeId","data-v-2d412516"]]);export{Ve as default};
