import{d as I,r as g,x as h,G as P,c as y,F as L,n as b,a as v,t as D,i as r,z as p,f as _,w as $,o as u,_ as B}from"./index-CSkJ4Wth.js";const O={class:"param-list-scrollable"},C={class:"input-container"},w={style:{flex:"1"}},R=I({__name:"ParamList",props:{params:{},modelValue:{},refs:{}},emits:["update:modelValue","update:refs"],setup(k,{expose:F,emit:U}){const d=k,V=U,c=g({}),m=g({}),x=()=>{c.value={...d.modelValue},m.value={...d.refs||{}}};h(()=>d.modelValue,o=>{c.value={...o}},{deep:!0}),h(()=>d.refs,o=>{m.value={...o||{}}},{deep:!0}),P(()=>{x()});const i=(o,e)=>{const t=d.params.find(s=>s.name===o);let a=e;if(t)if(t.paramType==="int")if(e===""||e===null||e===void 0)a=e;else{const s=parseInt(e);a=isNaN(s)?0:s}else if(t.paramType==="float")if(e===""||e===null||e===void 0)a=e;else if(typeof e=="string")if(/^-?(\d*\.?\d*|\.\d*)$/.test(e))a=e;else{const f=parseFloat(e);a=isNaN(f)?0:f}else a=e;else t.paramType==="bool"?a=!!e:a=e;c.value[o]=a,console.log("ParamList handleLocalInput:",o,"=",e,"处理后:",a,"本地表单:",c.value)},T=(o,e)=>{m.value[o]=e};F({getLocalFormData:()=>({form:{...c.value},refs:{...m.value}}),commitLocalData:()=>{console.log("=== ParamList commitLocalData 开始 ==="),console.log("当前 localForm:",{...c.value}),console.log("当前 localRefs:",{...m.value}),console.log("参数定义:",d.params);const o={...c.value};d.params.forEach(e=>{const t=o[e.name];if(console.log(`处理参数 ${e.name}:`,{原始值:t,类型:typeof t,参数类型:e.paramType}),e.paramType==="float"&&typeof t=="string"){const a=parseFloat(t),s=isNaN(a)?0:a;o[e.name]=s,console.log(`浮点数转换: "${t}" -> ${s}`)}else if(e.paramType==="int"&&typeof t=="string"){const a=parseInt(t),s=isNaN(a)?0:a;o[e.name]=s,console.log(`整数转换: "${t}" -> ${s}`)}else console.log(`保持原值: ${t}`)}),console.log("处理后的表单数据:",o),console.log("即将发射 update:modelValue 事件"),V("update:modelValue",o),V("update:refs",{...m.value}),console.log("=== ParamList commitLocalData 结束 ===")}});const N=o=>o.paramOption?o.paramOption.split(",").map(e=>e.trim()):["差距线性加权","取最大差距"];return(o,e)=>{const t=_("el-input"),a=_("el-checkbox"),s=_("el-option"),f=_("el-select");return u(),y("div",O,[(u(!0),y(L,null,b(o.params,l=>(u(),y("div",{key:l.id,class:"form-group"},[v("label",null,D(l.label)+":",1),v("div",C,[v("div",w,[l.paramType==="int"?(u(),r(t,{key:0,"model-value":c.value[l.name],type:"number",placeholder:"请输入"+l.label,"onUpdate:modelValue":n=>i(l.name,n)},null,8,["model-value","placeholder","onUpdate:modelValue"])):p("",!0),l.paramType==="float"?(u(),r(t,{key:1,"model-value":c.value[l.name],type:"text",placeholder:"请输入"+l.label,"onUpdate:modelValue":n=>i(l.name,n)},null,8,["model-value","placeholder","onUpdate:modelValue"])):p("",!0),l.paramType==="bool"?(u(),r(a,{key:2,"model-value":c.value[l.name],"onUpdate:modelValue":n=>i(l.name,n)},null,8,["model-value","onUpdate:modelValue"])):p("",!0),l.paramType==="enum"||l.paramOption?(u(),r(f,{key:3,"model-value":c.value[l.name],placeholder:"请选择"+l.label,"onUpdate:modelValue":n=>i(l.name,n)},{default:$(()=>[(u(!0),y(L,null,b(N(l),n=>(u(),r(s,{key:n,label:n,value:n},null,8,["label","value"]))),128))]),_:2},1032,["model-value","placeholder","onUpdate:modelValue"])):p("",!0),l.paramType==="string"&&!l.paramOption?(u(),r(t,{key:4,"model-value":c.value[l.name],type:"text",placeholder:"请输入"+l.label,"onUpdate:modelValue":n=>i(l.name,n)},null,8,["model-value","placeholder","onUpdate:modelValue"])):p("",!0),l.ref?(u(),r(t,{key:5,"model-value":m.value[l.name],type:"text",placeholder:"请输入引用值",class:"ref-input","onUpdate:modelValue":n=>T(l.name,n)},null,8,["model-value","onUpdate:modelValue"])):p("",!0)])])]))),128))])}}}),M=B(R,[["__scopeId","data-v-dd9597c0"]]);export{M as P};
