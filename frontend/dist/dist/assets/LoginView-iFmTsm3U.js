import{d as k,r as p,s as R,c as C,a as _,b as t,w as r,e as B,u as o,f as m,g as E,o as g,h as q,l as v,i as N,j as S,v as j,k as A,E as L,_ as M}from"./index-CSkJ4Wth.js";import{u as P}from"./auth-CnjZ6pwZ.js";import{l as U}from"./user-C0k7ncu5.js";import"./request-Bb7olHYx.js";import"./index-xsH4HHeE.js";const D={class:"overall"},I={class:"login-container"},O=k({__name:"LoginView",setup(T){const w=P(),h=E(),n=p(null),c=p(!1),u=p(!1),s=R({username:"",password:""}),V={username:[{required:!0,message:"请输入用户名",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"change"},{min:3,message:"密码长度不能少于3位",trigger:"change"}]},b=()=>{u.value=!u.value},x=()=>{n.value&&n.value.validate(async(f,e)=>{var l;if(!f){const a=e?Object.values(e)[0][0].message:"表单验证失败";L.error(a);return}c.value=!0;try{const a={username:s.username,password:s.password},i=await U(a);w.setAuth(i.token,i.name),h.push("/home"),s.password=""}catch{console.error("操作失败，请稍后重试")}finally{c.value=!1,(l=n.value)==null||l.clearValidate()}})};return(f,e)=>{const l=m("el-input"),a=m("el-form-item"),i=m("el-button"),y=m("el-form");return g(),C("div",D,[_("div",I,[e[3]||(e[3]=_("h2",{class:"title"},"欢迎登录",-1)),t(y,{ref_key:"formRef",ref:n,model:o(s),rules:V,onSubmit:B(x,["prevent"])},{default:r(()=>[t(a,{prop:"username"},{default:r(()=>[t(l,{modelValue:o(s).username,"onUpdate:modelValue":e[0]||(e[0]=d=>o(s).username=d),placeholder:"请输入用户名","prefix-icon":o(q),clearable:"",class:"custom-input"},null,8,["modelValue","prefix-icon"])]),_:1}),t(a,{prop:"password"},{default:r(()=>[t(l,{modelValue:o(s).password,"onUpdate:modelValue":e[1]||(e[1]=d=>o(s).password=d),type:u.value?"text":"password",placeholder:"请输入密码","prefix-icon":o(v),clearable:"",class:"custom-input"},{suffix:r(()=>[(g(),N(S(u.value?o(j):o(v)),{class:"eye-icon",onClick:b}))]),_:1},8,["modelValue","type","prefix-icon"])]),_:1}),t(a,null,{default:r(()=>[t(i,{type:"primary","native-type":"submit",class:"login-btn",loading:c.value},{default:r(()=>e[2]||(e[2]=[A(" 登录 ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}}),K=M(O,[["__scopeId","data-v-f6396b28"]]);export{K as default};
